---
id: debugging
title: Debugging
---

Tipps zum Debuggen deiner Mods während der Enwickling.

## Hot Reload {#hot-reload}

Die schnellste Möglichkeit zum Überprüfen von Änderungen ist "hot reloading". Nach dem Rekompilieren deiner Mod:

- Drücke ingame **Strg+Shift+R** (Windows/Linux) oder **Cmd+Shift+R** (Mac)
- Dadurch wird intern `api.reloadMods()` aufgerufen, worudch alle Callbacks, UI-Komponenten, benutzerdefinierte 
  Layer und Zugtypen geleert und alle Mod-Scripte neu ausgeführt werden.

Wenn du `pnpm dev` benutzt, kompiliert Vite automatisch beim Speichern von Dateien neu, sodass du nur die
Tastenkombination ingame drücken musst.

:::note

Hot Reloads leer die meisten Mod-States, aber ein paar Sachen bleiben bestehe (wie bereits gebaute Gleise und
Stationen). Wenn sich deine Mod daruch aufhängt ist ein Spieleneustart die sicherste Alternative.

:::

## Logging in der Konsole {#console-logging}

Nutze `console.log` mit einem Tag-Prefix, um den Output deiner Mod zu identifizieren:

```ts
const TAG = '[MeineMod]';
console.log(`${TAG} Initialisiert`);
console.warn(`${TAG} Etwas unerwartetes`, beliebigedaten);
console.error(`${TAG} Fehler beim laden`, error);
```

### Logs einsehen {#viewing-logs}

**Ingame**: Öffne die Entwicklerkonsole mit **Strg+Shift+I** (Windows/Linux) oder **Cmd+Option+I**
(Mac).

**Mit `pnpm dev`**: Logs werden in das Terminal geschrieben und unter `debug/latest.log` abgespeichert. Der launcher
aktiviert automatisch das Logging von Electron.

## Fehlerhandhabung {#error-handling}

Verpacke deine Initialisierung in try/catch um einen Spielabsturz zu vermeiden:

```ts
api.hooks.onMapReady((_map) => {
  if (initialized) return;
  initialized = true;

  try {
    // Setup Code
    console.log(`${TAG} Erfolgreich initialisiert.`);
  } catch (err) {
    console.error(`${TAG} Initialisieren fehlgeschlagen:`, err);
    api.ui.showNotification('Meine-Mod nicht geladen. Konsole prüfen.', 'error');
  }
});
```

Für sich wiederholende Hooks kannst du jeden Callback verpacken:

```ts
api.hooks.onDayChange((day) => {
  try {
    // Deine Logik
  } catch (err) {
    console.error(`${TAG} Fehler an Tag ${day}:`, err);
  }
});
```

## Spielfehler-Hooks {#game-error-hooks}

Die API stellt Hookds zum Catchen von Warnungen und Fehlern des Spiels bereit:

```ts
api.hooks.onWarning((message) => {
  console.warn(`${TAG} Game warning:`, message);
});

api.hooks.onError((error) => {
  console.error(`${TAG} Game error:`, error);
});
```

## Type Checking {#type-checking}

Führe den TypeScript Checker aus, um Fehler vor der Kompilierung zu finden:

```bash
pnpm typecheck
```

Dadurch wird `tsc --noEmit` ausgeführt und jeder Fehler ohne vorheriges erzeugen von Output-Dateien gemeldet.
Es ist empfehlenswert, das vor dem Spielstart auszuführen.

## Häufige Probleme {#common-issues}

### "SubwayBuilderAPI Not Found" {#subwaybuilderapi-not-found}

Dein Modscript wurde ausgeführt bevor das Spiel die API initialisiert hat. Das sollte mit der Struktur der
Vorlage nicht passiere, aber falls doch:

- Stelle sicher `main` in `manifest.json` ist `"index.js"`
- Stelle sicher, dass du `if (!api)` vor dem Nutzen der API überprüfst

### UI wird nicht angezeigt {#ui-not-showing-up}

- Prüfe, dass du UI in `onMapReady` registrierst — das UI-System ist nicht bereit, bevor die Map geladen wurde
- Überprüfe, dass deine Komponente beim Rendern keine Fehler auslöst (Konsole für React Errors prüfen)
- Stell sicher, dass deine `id` einzigartig ist, duplikate werden ohne Fehler abgelehnt

### Änderungen werden nach Reload nicht sichtbar {#changes-not-appearing-after-reload}

- Überprüfe korrekte Kompilierung durch Vite (Terminal nach Build Errors prüfen)
- Stelle sicher, dass der Symlink noch intakt ist (`pnpm dev:link`)
- Starte das Spiel neu, wenn ein Hot Reload keine Änderungen erkennt

### React Hook Fehler ("Invalid Hook Call") {#react-hooks-errors}

Normalerweise bedeutet das, dass es mehrere React-Instanzen gibt. Stelle sicher:

- Du importiertst von `'react'` (und installierst React nicht als Dependency)
- Das Vite-Alias in `vite.config.ts` zeigt richtigerweise auf `src/types/react.ts`
- Du hast nicht zufällig `react` in `node_modules` installiert

### Windows Symlink Berechtigungsfehler {#windows-symlink-permission-error}

Auf Windows können für das Erstellen von Symlinks Administratorreche nötig sein. Entweder:

- Führe das Terminal als Admin aus
- Aktiviere den Entwicklermodus in den Windows Einstellungen (Einstellungen > System > Erweitert > Entwicklermodus)
